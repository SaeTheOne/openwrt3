#!/bin/bash

# ??1: ?????????feeds?packages??python3-distutils??
echo "?? ???????python3-distutils??..."
sed -i 's/python3-distutils/python3-setuptools/g' feeds/packages/lang/python/*/Makefile

# ??2: ??package/feeds??????Makefile
find package/feeds -name "Makefile" -type f | xargs sed -i 's/python3-distutils/python3-setuptools/g'

# ??3: ???????python3-distutils???
echo "?? ???????python3-distutils???..."
for pkg in babel docker incremental fail2ban flent; do
  echo "?? ??python-${pkg}..."
  find package/feeds -name "python-${pkg}" -type d | xargs -r -I{} sed -i 's/python3-distutils/python3-setuptools/g' {}/Makefile
done

# ??4: ????????python3-distutils
echo "?? ????????python3-distutils..."
find package/feeds -name "Makefile" -type f -exec grep -l '+python3-distutils' {} \; | xargs -r sed -i 's/+python3-distutils/+python3-setuptools/g'

echo "? ??????!"
