    - name: 克隆源码到临时目录（强制拉取稳定版）
      working-directory: ${{ env.TEMP_DIR }}
      run: |
        # 彻底清理旧源码（避免缓存影响）
        sudo rm -rf openwrt
        # 克隆指定的v24.10.2稳定版，确保代码完整
        git clone $REPO_URL -b v24.10.2 --depth 1 openwrt
        # 验证分支是否正确切换
        cd openwrt
        echo "当前分支：$(git branch --show-current)"
        echo "最新提交：$(git log -1 --pretty=format:%H)"
        # 创建软链接并修复权限
        ln -sf ${{ env.TEMP_DIR }}/openwrt $GITHUB_WORKSPACE/openwrt
        sudo chown -R $USER:$GROUPS ${{ env.TEMP_DIR }}/openwrt

    - name: 移除稳定版中仍存在的冲突补丁
      run: |
        # 检查v24.10.2中是否仍有068系列补丁，如有则全部删除
        CONFLICT_PATCH_DIR="${{ env.TEMP_DIR }}/openwrt/target/linux/generic/backport-6.6"
        if [ -d "$CONFLICT_PATCH_DIR" ]; then
          CONFLICT_PATCHES=$(find "$CONFLICT_PATCH_DIR" -name "068-*.patch")
          if [ -n "$CONFLICT_PATCHES" ]; then
            echo "v24.10.2中仍发现冲突补丁，删除："
            echo "$CONFLICT_PATCHES"
            sudo rm -f $CONFLICT_PATCHES
          else
            echo "v24.10.2中未发现068系列补丁，跳过"
          fi
        else
          echo "补丁目录不存在，跳过"
        fi
